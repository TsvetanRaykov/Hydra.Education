import{top,left,right,bottom,end}from"../enums.js";import getOffsetParent from"../dom-utils/getOffsetParent.js";import getWindow from"../dom-utils/getWindow.js";import getDocumentElement from"../dom-utils/getDocumentElement.js";import getComputedStyle from"../dom-utils/getComputedStyle.js";import getBasePlacement from"../utils/getBasePlacement.js";import getVariation from"../utils/getVariation.js";import{round}from"../utils/math.js";var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function roundOffsetsByDPR(t){var e=t.x,o=t.y,t=window.devicePixelRatio||1;return{x:round(round(e*t)/t)||0,y:round(round(o*t)/t)||0}}function mapToStyles(t){var e=t.popper,o=t.popperRect,s=t.placement,i=t.variation,r=t.offsets,a=t.position,p=t.gpuAcceleration,n=t.adaptive,l=t.roundOffsets,m=!0===l?roundOffsetsByDPR(r):"function"==typeof l?l(r):r,f=m.x,d=void 0===f?0:f,u=m.y,c=void 0===u?0:u,g=r.hasOwnProperty("x"),y=r.hasOwnProperty("y"),t=left,l=top,f=window;n&&(m="clientHeight",u="clientWidth",(r=getOffsetParent(e))===getWindow(e)&&(r=getDocumentElement(e),"static"!==getComputedStyle(r).position&&"absolute"===a&&(m="scrollHeight",u="scrollWidth")),s!==top&&(s!==left&&s!==right||i!==end)||(l=bottom,c-=r[m]-o.height,c*=p?1:-1),s!==left&&(s!==top&&s!==bottom||i!==end)||(t=right,d-=r[u]-o.width,d*=p?1:-1));var n=Object.assign({position:a},n&&unsetSides);return p?Object.assign({},n,((p={})[l]=y?"0":"",p[t]=g?"0":"",p.transform=(f.devicePixelRatio||1)<=1?"translate("+d+"px, "+c+"px)":"translate3d("+d+"px, "+c+"px, 0)",p)):Object.assign({},n,((n={})[l]=y?c+"px":"",n[t]=g?d+"px":"",n.transform="",n))}function computeStyles(t){var e=t.state,o=t.options,s=o.gpuAcceleration,t=void 0===s||s,s=o.adaptive,s=void 0===s||s,o=o.roundOffsets,o=void 0===o||o,t={placement:getBasePlacement(e.placement),variation:getVariation(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:t};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,mapToStyles(Object.assign({},t,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:o})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,mapToStyles(Object.assign({},t,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:o})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}export default{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:computeStyles,data:{}};export{mapToStyles};